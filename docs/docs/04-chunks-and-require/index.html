<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Code chunks#Lua executes its code in blocks of statements, called chunks. Lua interpreter can execute statement from interactive mode, or load the chunk from a file. Lua interpreter compiles the statements to a byte code, which is then executed.
You can execute a statement directly as parameter of Lua interpreter using -e switch like this:
lua -e &#34;print('Hello world')&#34; Lua chunk can be a file with .lua extension, created in any text editor."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="04. Chunks and require"><meta property="og:description" content="Code chunks#Lua executes its code in blocks of statements, called chunks. Lua interpreter can execute statement from interactive mode, or load the chunk from a file. Lua interpreter compiles the statements to a byte code, which is then executed.
You can execute a statement directly as parameter of Lua interpreter using -e switch like this:
lua -e &#34;print('Hello world')&#34; Lua chunk can be a file with .lua extension, created in any text editor."><meta property="og:type" content="article"><meta property="og:url" content="https://martinkunc.github.io/lua-tutorial/docs/04-chunks-and-require/"><meta property="article:section" content="docs"><title>04. Chunks and require | Lua tutorial</title><link rel=manifest href=/lua-tutorial/manifest.json><link rel=icon href=/lua-tutorial/favicon.png type=image/x-icon><link rel=stylesheet href=/lua-tutorial/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin=anonymous><script defer src=/lua-tutorial/flexsearch.min.js></script>
<script defer src=/lua-tutorial/en.search.min.80257eee436072364c20f78c9ef0d9bd1202665517414e7231f6f986aad3cabc.js integrity="sha256-gCV+7kNgcjZMIPeMnvDZvRICZlUXQU5yMfb5hqrTyrw=" crossorigin=anonymous></script>
<script src=https://martinkunc.github.io/lua-tutorial//js/lua.vm.js?1662824463></script>
<link rel=stylesheet href=https://martinkunc.github.io/lua-tutorial//css/codemirror.css?1662824463><script src=https://martinkunc.github.io/lua-tutorial//js/codemirror.js?1662824463></script>
<link rel=stylesheet href=https://martinkunc.github.io/lua-tutorial//css/styles.css?1662824463><script src=https://martinkunc.github.io/lua-tutorial//js/lua.js?1662824463></script>
<script src=https://martinkunc.github.io/lua-tutorial//js/luacode.js?1662824463></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/lua-tutorial/><span>Lua tutorial</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/lua-tutorial/docs/01-installation/>01. Installation</a></li><li><a href=/lua-tutorial/docs/02-introduction/>02. Introduction</a></li><li><a href=/lua-tutorial/docs/03-types/>03. Types</a></li><li><a href=/lua-tutorial/docs/04-chunks-and-require/ class=active>04. Chunks and require</a></li><li><a href=/lua-tutorial/docs/05-string-functions/>05. String functions</a></li><li><a href=/lua-tutorial/docs/06-arrays/>06. Arrays and tables</a></li><li><a href=/lua-tutorial/docs/07-if-condition-operators/>07. If condition and operators</a></li><li><a href=/lua-tutorial/docs/08-functions-local-and-global-scope/>08. Functions, local and global scope</a></li><li><a href=/lua-tutorial/docs/09-functions-with-multiple-results/>09. Functions with multiple results</a></li><li><a href=/lua-tutorial/docs/10-closures-iterators/>10. Closures and Iterators</a></li><li><a href=/lua-tutorial/docs/11-table-key-value-pairs/>11. Table Key value pairs</a></li><li><a href=/lua-tutorial/docs/12-for-cycle/>12. For Cycle</a></li><li><a href=/lua-tutorial/docs/13-while-and-repeat-cycles/>13. While and repeat cycles</a></li><li><a href=/lua-tutorial/docs/15-common-standard-libraries-copy/>15. Common standard libraries</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/lua-tutorial/svg/menu.svg class=book-icon alt=Menu></label>
<strong>04. Chunks and require</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=code-chunks>Code chunks
<a class=anchor href=#code-chunks>#</a></h1><p>Lua executes its code in blocks of statements, called chunks. Lua interpreter can execute statement from interactive mode, or load the chunk from a file.
Lua interpreter compiles the statements to a byte code, which is then executed.</p><p>You can execute a statement directly as parameter of Lua interpreter using -e switch like this:</p><pre tabindex=0><code>lua -e &#34;print(&#39;Hello world&#39;)&#34;
</code></pre><p>Lua chunk can be a file with .lua extension, created in any text editor. After
saving it can be executed in the lua interpreter using -l command line switch.
For example:</p><pre tabindex=0><code>lua -l helloworld.lua
</code></pre><p>Note: space after -l is optional.</p><p>Because the file is just one of chunks executed by Lua interpreter, you can execute many of chunks from different files using.</p><p>For example, when you have file file1.lua with content:</p><pre tabindex=0><code>s = &#34;Hello world&#34;
</code></pre><p>and another file file2.lua with content:</p><pre tabindex=0><code>print(s)
</code></pre><p>Then you can load both chunks (Lua will use require) and last switch &ldquo;-e&rdquo; will make Lua interpreter exit after printing content of variable set in first chunk.</p><pre tabindex=0><code>% lua -lfile1 -lfile2 -e &#34;os.exit(1)&#34;
Hello world
</code></pre><h2 id=require-statement>Require statement
<a class=anchor href=#require-statement>#</a></h2><p>Because chunks of statements might need another file or a lua module, Lua has function require. It tries to find the file in Lua Path and if it wasn&rsquo;t loaded yet, it loads it.
Now, lets consider we still have file1.lua which sets variable s to &ldquo;Hello World&rdquo;. We can create another file, for example called use_file1.lua with content:</p><pre tabindex=0><code>require(&#34;file1&#34;)
print(s)
</code></pre><p>Where the require function checks if module &ldquo;file1&rdquo; is already loaded, eventually loads it. The consequent print will reuse the defined variable and prints its content, so that output of this command will be Hello World.
The command to execute with output:</p><pre tabindex=0><code>% lua -l use_file1 -e &#34;os.exit(1)&#34;
Hello world
</code></pre><p>Please note, that when loading a module with -l or require function, we dont specify the .lua extension. It is because of how Lua is resolving modules.</p><p>Lua first check if environment variable LUA_PATH exists, if it does, tries to extract path patterns from it.
The file patterns is a list of paths to search for modules where ? can be used instead of part of file name.
Standard paths which Lua searches in can be printed by:</p><pre tabindex=0><code>% lua -e &#34;print(package.path)&#34;
/usr/local/share/lua/5.4/?.lua;/usr/local/share/lua/5.4/?/init.lua;/usr/local/lib/lua/5.4/?.lua;/usr/local/lib/lua/5.4/?/init.lua;./?.lua;./?/init.lua
</code></pre><p>It is semicolon separated list of patterns. Most interestring is &ldquo;./?.lua&rdquo; which searches for file name specified in require (instead of ?) with .lua extension in current working directory.</p><h2 id=dofile-function>Dofile function
<a class=anchor href=#dofile-function>#</a></h2><p>Similarly to require, dofile is a function which loads chunk of statements. But it doesn&rsquo;t search for file in Lua Path. Because of this, extension is required. Also, dofile doesn&rsquo;t check whether the file was loaded and loads it again always.</p><p>To execute same two chunks as we used above, we can use dofile like this:</p><pre tabindex=0><code>% lua -e &#34;dofile(&#39;file1.lua&#39;) dofile(&#39;file2.lua&#39;) os.exit(1)&#34;
Hello world
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>